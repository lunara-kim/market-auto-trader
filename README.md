# Market Auto Trader (μ‹μ¥ μλ™λ§¤λ§¤ ν”„λ΅κ·Έλ¨) π“

ν•κµ­ν¬μμ¦κ¶ OpenAPI κΈ°λ° μλ™λ§¤λ§¤ ν”„λ΅κ·Έλ¨μ…λ‹λ‹¤. λ‹¤μ–‘ν• κΈ°μ μ  λ¶„μ„ μ „λµ, μλ™ λ¦¬λ°Έλ°μ‹±, μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§, κ·Έλ¦¬κ³  μ²΄κ³„μ μΈ λ¦¬μ¤ν¬ κ΄€λ¦¬λ¥Ό μ§€μ›ν•©λ‹λ‹¤.

## π― μ£Όμ” κΈ°λ¥

### λ§¤λ§¤ μ „λµ
- **μ΄λ™ν‰κ·  κµμ°¨ μ „λµ** β€” SMA/EMA κ³¨λ“ ν¬λ΅μ¤Β·λ°λ“ν¬λ΅μ¤ κΈ°λ° λ§¤λ§¤ μ‹ νΈ
- **RSI (μƒλ€κ°•λ„μ§€μ) μ „λµ** β€” κ³Όλ§¤μ/κ³Όλ§¤λ„ νλ‹¨
- **λ³Όλ¦°μ € λ°΄λ“ μ „λµ** β€” λ°΄λ“ μ΄νƒ μ‹ λ§¤λ§¤ μ‹ νΈ
- **λ³µν•© μ „λµ λ§¤λ‹μ €** β€” λ‹¤μ¤‘ μ „λµ μ‹ νΈ μΆ…ν•© (λ‹¤μκ²°/κ°€μ¤‘/λ§μ¥μΌμΉ ν¬ν‘)
- **λ°±ν…μ¤ν… μ—”μ§„** β€” μμλ£Β·μ„ΈκΈΒ·MDDΒ·μƒ¤ν”„λΉ„μ¨ ν¬ν•¨ μ „λµ κ²€μ¦

### μλ™ λ§¤λ§¤
- **ν•ν¬ OpenAPI μ—°λ™** β€” μ‹μ„Έ μ΅°ν, λ§¤μ/λ§¤λ„ μ£Όλ¬Έ, μ”κ³  μ΅°ν
- **μ›μƒ· μ£Όλ¬Έ** β€” κµ­λ‚΄/ν•΄μ™Έ μΆ…λ© μ¦‰μ‹ λ§¤μ
- **μλ™ λ¦¬λ°Έλ°μ‹±** β€” λ©ν‘ λΉ„μ¤‘ κΈ°λ° μλ™ λ§¤λ§¤ (μΌ/μ£Ό/μ›” μ¤μΌ€μ¤„)
- **λ¦¬μ¤ν¬ κ΄€λ¦¬** β€” μµλ€ μ†μ‹¤ μ ν•, ν¬μ§€μ… μ‚¬μ΄μ§•

### μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§
- **WebSocket μ‹¤μ‹κ°„ μ‹μ„Έ** β€” ν•ν¬ WebSocket API μ—°λ™, μλ™ μ¬μ—°κ²°
- **PnL λ€μ‹λ³΄λ“ API** β€” μ‹¤μ‹κ°„ ν¬νΈν΄λ¦¬μ¤ μ†μµ μ΅°ν
- **μ•λ¦Ό μ‹μ¤ν…** β€” μ†μ /λ©ν‘κ°€/κΈ‰λ“±κΈ‰λ½/κ±°λλ‰ μ΄μƒ μ‹ Discord μ•λ¦Ό
- **μƒμ„Έ ν—¬μ¤μ²΄ν¬** β€” DB μ—°κ²°, API μƒνƒ, μ—…νƒ€μ„ λ¨λ‹ν„°λ§

### λ°μ΄ν„° κ΄€λ¦¬
- **μΌλ΄‰ λ°μ΄ν„° μλ™ μμ§‘** β€” μ¤μΌ€μ¤„ κΈ°λ° DB μ €μ¥
- **νμ¤ν† λ¦¬μ»¬ λ°μ΄ν„° μΊμ‹** β€” DB μΊμ‹±μΌλ΅ API νΈμ¶ μ μ•½
- **λ°μ΄ν„° ν’μ§ κ²€μ¦** β€” OHLCV μ ν¨μ„±, μ΄μƒμΉ/λ„λ½μΌ νƒμ§€
- **κ±°λ λ¦¬ν¬νΈ** β€” μΌμΌ μ”μ•½, ν¬νΈν΄λ¦¬μ¤ μ¤λƒ…μƒ·, μ‹¤ν„ μ†μµ κ³„μ‚°

## π›  κΈ°μ  μ¤νƒ

| μμ—­ | κΈ°μ  |
|------|------|
| **Backend** | Python 3.13, FastAPI, Pydantic v2 |
| **Database** | PostgreSQL, SQLAlchemy 2.0, Alembic |
| **Trading API** | ν•κµ­ν¬μμ¦κ¶ OpenAPI (REST + WebSocket) |
| **Testing** | pytest (726+ ν…μ¤νΈ), pytest-asyncio |
| **Lint** | ruff |
| **Infra** | Docker, Docker Compose, GitHub Actions CI |

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
market-auto-trader/
β”β”€β”€ config/
β”‚   β”β”€β”€ settings.py          # μ•± κΈ°λ³Έ μ„¤μ •
β”‚   β”β”€β”€ trading.py           # λ§¤λ§¤ μ„¤μ • (μμλ£, μ„ΈκΈ, μ „λµ νλΌλ―Έν„°)
β”‚   β”β”€β”€ backtest.py          # λ°±ν…μ¤νΈ μ„¤μ • (μ΄κΈ°μλ³Έ, λ¬΄μ„ν—μμµλ¥ )
β”‚   β””β”€β”€ portfolio.py         # ν¬νΈν΄λ¦¬μ¤ μ„¤μ • (λ©ν‘ λΉ„μ¤‘, λ¦¬λ°Έλ°μ‹±)
β”β”€β”€ src/
β”‚   β”β”€β”€ main.py              # FastAPI μ•± μ—”νΈλ¦¬ν¬μΈνΈ
β”‚   β”β”€β”€ db.py                # DB μ—°κ²° μ„¤μ •
β”‚   β”β”€β”€ exceptions.py        # μ»¤μ¤ν…€ μμ™Έ
β”‚   β”β”€β”€ api/
β”‚   β”‚   β”β”€β”€ routes.py        # κΈ°λ³Έ λΌμ°ν„° (ν—¬μ¤μ²΄ν¬)
β”‚   β”‚   β”β”€β”€ orders.py        # μ£Όλ¬Έ API
β”‚   β”‚   β”β”€β”€ portfolio.py     # ν¬νΈν΄λ¦¬μ¤ API
β”‚   β”‚   β”β”€β”€ signals.py       # λ§¤λ§¤ μ‹ νΈ API
β”‚   β”‚   β”β”€β”€ policies.py      # μ›μƒ· μ£Όλ¬Έ μ •μ±… API
β”‚   β”‚   β”β”€β”€ alerts.py        # μ•λ¦Ό κ΄€λ¦¬ API
β”‚   β”‚   β”β”€β”€ rebalancing.py   # λ¦¬λ°Έλ°μ‹± API
β”‚   β”‚   β”β”€β”€ streaming.py     # μ‹¤μ‹κ°„ μ¤νΈλ¦¬λ° API
β”‚   β”‚   β”β”€β”€ dashboard.py     # PnL λ€μ‹λ³΄λ“ API
β”‚   β”‚   β”β”€β”€ data_pipeline.py # λ°μ΄ν„° νμ΄ν”„λΌμΈ API
β”‚   β”‚   β”β”€β”€ trade_report.py  # κ±°λ λ¦¬ν¬νΈ API
β”‚   β”‚   β”β”€β”€ health.py        # μƒμ„Έ ν—¬μ¤μ²΄ν¬ API
β”‚   β”‚   β””β”€β”€ strategy_manager.py  # μ „λµ λΉ„κµ API
β”‚   β”β”€β”€ broker/
β”‚   β”‚   β””β”€β”€ kis_client.py    # ν•ν¬ OpenAPI ν΄λΌμ΄μ–ΈνΈ
β”‚   β”β”€β”€ data/
β”‚   β”‚   β”β”€β”€ collector.py     # μ‹μ¥ λ°μ΄ν„° μμ§‘
β”‚   β”‚   β”β”€β”€ pipeline.py      # μΌλ΄‰ λ°μ΄ν„° νμ΄ν”„λΌμΈ
β”‚   β”‚   β”β”€β”€ cache.py         # λ°μ΄ν„° μΊμ‹± λ μ΄μ–΄
β”‚   β”‚   β””β”€β”€ quality.py       # λ°μ΄ν„° ν’μ§ κ²€μ¦
β”‚   β”β”€β”€ strategy/
β”‚   β”‚   β”β”€β”€ base.py          # BaseStrategy μ¶”μƒ ν΄λμ¤
β”‚   β”‚   β”β”€β”€ moving_average.py    # μ΄λ™ν‰κ·  κµμ°¨ μ „λµ
β”‚   β”‚   β”β”€β”€ rsi.py               # RSI μ „λµ
β”‚   β”‚   β”β”€β”€ bollinger_bands.py   # λ³Όλ¦°μ € λ°΄λ“ μ „λµ
β”‚   β”‚   β”β”€β”€ strategy_manager.py  # λ³µν•© μ „λµ λ§¤λ‹μ €
β”‚   β”‚   β”β”€β”€ rebalancer.py       # λ¦¬λ°Έλ°μ‹± μ—”μ§„
β”‚   β”‚   β”β”€β”€ rebalance_scheduler.py  # λ¦¬λ°Έλ°μ‹± μ¤μΌ€μ¤„λ¬
β”‚   β”‚   β””β”€β”€ risk.py             # λ¦¬μ¤ν¬ κ΄€λ¦¬
β”‚   β”β”€β”€ streaming/
β”‚   β”‚   β””β”€β”€ websocket_client.py  # KIS WebSocket μ‹¤μ‹κ°„ μ‹μ„Έ
β”‚   β”β”€β”€ notification/
β”‚   β”‚   β”β”€β”€ alert_manager.py     # μ•λ¦Ό κ·μΉ™ κ΄€λ¦¬
β”‚   β”‚   β””β”€β”€ discord_notifier.py  # Discord μ•λ¦Ό μ—°λ™
β”‚   β””β”€β”€ utils/
β”‚       β”β”€β”€ retry.py         # Exponential backoff μ¬μ‹λ„
β”‚       β”β”€β”€ trade_report.py  # κ±°λ λ¦¬ν¬νΈ μ ν‹Έ
β”‚       β””β”€β”€ logger.py        # λ΅κΉ… μ„¤μ •
β”β”€β”€ alembic/                 # DB λ§μ΄κ·Έλ μ΄μ…
β”β”€β”€ tests/                   # 726+ ν…μ¤νΈ
β”β”€β”€ docker-compose.yml
β”β”€β”€ Dockerfile
β”β”€β”€ requirements.txt
β””β”€β”€ .github/workflows/ci.yml # GitHub Actions CI
```

## π€ μ„¤μΉ λ° μ‹¤ν–‰

### 1. ν™κ²½ μ„¤μ •

```bash
git clone https://github.com/lunara-kim/market-auto-trader.git
cd market-auto-trader

cp .env.example .env
# .env νμΌμ— ν•ν¬ API ν‚¤ λ“± μ„¤μ •
```

### 2. Dockerλ΅ μ‹¤ν–‰

```bash
docker compose up -d          # PostgreSQL + μ•± μ‹¤ν–‰
docker compose logs -f app    # λ΅κ·Έ ν™•μΈ
```

### 3. λ΅μ»¬ κ°λ° λ¨λ“

```bash
python3.13 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# DB λ§μ΄κ·Έλ μ΄μ…
alembic upgrade head

# μ•± μ‹¤ν–‰
uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. ν…μ¤νΈ μ‹¤ν–‰

```bash
python -m pytest -q           # μ „μ²΄ ν…μ¤νΈ
python -m pytest --tb=short   # μ‹¤ν¨ μ‹ μƒμ„Έ μ¶λ ¥
```

### 5. API λ¬Έμ„

- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc
- ν—¬μ¤μ²΄ν¬: http://localhost:8000/health
- μƒμ„Έ ν—¬μ¤: http://localhost:8000/api/v1/health/detailed

## π“ API μ—”λ“ν¬μΈνΈ

| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | μ„¤λ… |
|-----------|--------|------|
| `/health` | GET | κΈ°λ³Έ ν—¬μ¤μ²΄ν¬ |
| `/api/v1/health/detailed` | GET | μƒμ„Έ ν—¬μ¤μ²΄ν¬ (DB, API μƒνƒ) |
| `/api/v1/orders` | POST/GET | μ£Όλ¬Έ μ‹¤ν–‰ λ° λ‚΄μ—­ μ΅°ν |
| `/api/v1/portfolio` | GET | ν¬νΈν΄λ¦¬μ¤ ν„ν™© |
| `/api/v1/portfolio/summary` | GET | ν¬νΈν΄λ¦¬μ¤ μ”μ•½ |
| `/api/v1/signals` | POST | λ§¤λ§¤ μ‹ νΈ μƒμ„± |
| `/api/v1/strategies/available` | GET | μ‚¬μ© κ°€λ¥ν• μ „λµ λ©λ΅ |
| `/api/v1/strategies/signal` | POST | λ³µν•© μ „λµ μ‹ νΈ |
| `/api/v1/strategies/compare` | POST | μ „λµλ³„ μ„±κ³Ό λΉ„κµ |
| `/api/v1/alerts` | CRUD | μ•λ¦Ό κ·μΉ™ κ΄€λ¦¬ |
| `/api/v1/rebalancing` | POST/GET | λ¦¬λ°Έλ°μ‹± μ‹¤ν–‰/λ‚΄μ—­ |
| `/api/v1/dashboard` | GET | PnL λ€μ‹λ³΄λ“ |
| `/api/v1/streaming` | WS/GET | μ‹¤μ‹κ°„ μ‹μ„Έ |
| `/api/v1/data-pipeline` | POST/GET | λ°μ΄ν„° μμ§‘/μƒνƒ |
| `/api/v1/reports` | GET | κ±°λ λ¦¬ν¬νΈ |

## π“ κ°λ° λ΅λ“λ§µ

### Phase 1: κΈ°μ΄ μΈν”„λΌ β…
Docker, CI/CD, DB λ§μ΄κ·Έλ μ΄μ…, ν•ν¬ API ν΄λΌμ΄μ–ΈνΈ, μ‹μ¥ λ°μ΄ν„° μμ§‘

### Phase 2: μ „λµ + API β…
μ΄λ™ν‰κ·  μ „λµ, λ°±ν…μ¤ν…, ν¬νΈν΄λ¦¬μ¤/μ£Όλ¬Έ API, λ¦¬μ¤ν¬ κ΄€λ¦¬, config κµ¬μ΅°ν™”

### Phase 3: μλ™ λ§¤λ§¤ μ‹μ¤ν… κ³ λ„ν™” β…
- 3-1: μ „λµ λ‹¤λ³€ν™” (RSI, λ³Όλ¦°μ € λ°΄λ“, λ³µν•© μ „λµ λ§¤λ‹μ €)
- 3-2: μλ™ λ¦¬λ°Έλ°μ‹± (λ©ν‘ λΉ„μ¤‘, μ¤μΌ€μ¤„λ¬, λ‚΄μ—­ DB)
- 3-3: μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§ (WebSocket, PnL λ€μ‹λ³΄λ“, μ•λ¦Ό)
- 3-4: λ°μ΄ν„° νμ΄ν”„λΌμΈ (μλ™ μμ§‘, μΊμ‹±, ν’μ§ κ²€μ¦)
- 3-5: μ΄μ μ•μ •μ„± (μ—λ¬ μ¬μ‹λ„, ν—¬μ¤μ²΄ν¬, κ±°λ λ¦¬ν¬νΈ)

### Phase 4: ν”„λ΅λ•μ… μ¤€λΉ„ (μμ •)
- ν”„λ΅ νΈμ—”λ“ λ€μ‹λ³΄λ“ (React)
- λ¨μν¬μ μ—°λ™ ν…μ¤νΈ
- λ°°ν¬ νμ΄ν”„λΌμΈ (CD)
- λ¨λ‹ν„°λ§ (Prometheus + Grafana)

## β οΈ μ£Όμμ‚¬ν•­

- μ΄ ν”„λ΅μ νΈλ” **κµμ΅ λ° μ—°κµ¬ λ©μ **μΌλ΅ κ°λ°λμ—μµλ‹λ‹¤.
- μ‹¤μ  ν¬μμ— μ‚¬μ©ν•κΈ° μ „μ— μ¶©λ¶„ν• λ¨μν¬μ ν…μ¤νΈκ°€ ν•„μ”ν•©λ‹λ‹¤.
- ν¬μλ΅ μΈν• μ†μ‹¤μ€ μ‚¬μ©μ λ³ΈμΈμ μ±…μ„μ…λ‹λ‹¤.
- ν•κµ­ν¬μμ¦κ¶ API μ‚¬μ© μ‹ μ•½κ΄€μ„ μ¤€μν•΄μ•Ό ν•©λ‹λ‹¤.

## π“„ λΌμ΄μ„ μ¤

MIT License β€” [LICENSE](LICENSE) μ°Έκ³ 

## π¤ κΈ°μ—¬

μ΄μ λ° ν’€ λ¦¬ν€μ¤νΈ ν™μν•©λ‹λ‹¤!
